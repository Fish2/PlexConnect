getLabel=function(e,t){var o=e.getElementByTagName(t);return o?o.textContent:""},setLabel=function(e,t,o){var n=e.getElementByTagName(t);n||(n=document.makeElementNamed(t),e.appendChild(n)),n.textContent=o},showPict=function(e,t){var o=e.getElementByTagName("accessories");o||(o=document.makeElementNamed("accessories"),e.appendChild(o));var n=document.makeElementNamed(t);o.appendChild(n)},hidePict=function(e,t){var o=e.getElementByTagName("accessories");o&&(o=o.getElementByTagName(t)),o&&o.removeFromParent()},doXMLHttpRequest=function(e,t,o){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&(200==n.status?t(n.responseXML):o())},n.open("GET",e,!0),n.send()},switchHomeUser=function(e,t){var o=e,n="",i=document.getElementById(e);if(i){var s=!i.getElementByTagName("paired");showPinEntryPage=function(e,t,o,n,i){log("switchHomeUser - showPinEntryPage");var s=new atv.PINEntry;s.title=e,s.prompt=t,s.initialPINCode=o,s.numDigits=4,s.userEditable=!0,s.hideDigits=!1,s.onSubmit=n,s.onCancel=i,s.show()},gotPin=function(e){log("switchHomeUser - gotPin"),n=e,doLogin()},gotCancel=function(){log("switchHomeUser - gotCancel");var e="{{URL(/PMS(plex.tv)/api/home/users)}}&PlexConnect=MyPlexLogoutHomeUser&PlexConnectUDID="+atv.device.udid;doXMLHttpRequest(e,gotLoginResponse,gotError)},doLogin=function(){log("switchHomeUser - doLogin");var e="{{URL(/PMS(plex.tv)/api/home/users)}}&PlexConnect=MyPlexSwitchHomeUser&PlexConnectCredentials="+encodeURIComponent(o+":"+n)+"&PlexConnectUDID="+atv.device.udid;doXMLHttpRequest(e,gotLoginResponse,gotError)},gotLoginResponse=function(e){log("switchHomeUser - gotLoginResponse");var t=e.getElementById(o);setLabel(i,"rightLabel",getLabel(t,"rightLabel"));var n=t.getElementByTagName("paired");s&&n?(showPict(i,"paired"),log("switchHomeUser - login done")):s&&!n?(setLabel(i,"rightLabel","{{TEXT(Failed)}}"),log("switchHomeUser - login failed")):log("switchHomeUser - logout done"),hidePict(i,"spinner")},gotError=function(){log("switchHomeUser - gotError"),setLabel(i,"rightLabel","{{TEXT(Failed)}}"),hidePict(i,"spinner")},log("switchHomeUser"),elem=document.getElementById("myPlexHomeUsers"),elems=elem.getElementsByTagName("oneLineMenuItem");for(var a=0;a<elems.length;a++)hidePict(elems[a],"paired"),setLabel(elems[a],"rightLabel","");if(showPict(i,"spinner"),s)if("1"==t){var r=getLabel(i,"label");showPinEntryPage("{{TEXT(PlexHome User PIN)}}","{{TEXT(Enter the PlexHome user pin for {0}.)}}".format(r),"0000",gotPin,gotCancel)}else gotPin("");else{var l="{{URL(/PMS(plex.tv)/api/home/users)}}&PlexConnect=MyPlexLogoutHomeUser&PlexConnectUDID="+atv.device.udid;doXMLHttpRequest(l,gotLoginResponse,gotError)}}};